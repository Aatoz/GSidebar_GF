<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Grace Fellowship Bulletin Formatter</title>
<link rel="stylesheet" type="text/css" href="view.css" media="all">
<script type="text/javascript" src="view.js"></script>

</head>
<body id="main_body" >
	<div id="form_container">

	<img src="top.png" style="width:270px;height:10px;margin-bottom:1px">
	<h1 style="Text-Align:Center">Lyrical Creator</h1>
	<img src="bottom.png" style="width:270px;height:10px;margin-top:1px">

	<form id="form_1711" class="appnitro" method="post" action="">
		<ul>
		<li id="li_1" >
		<label class="description" for="%SongName%">Song title</label>
		<div>
			<input id="%SongName%" name="Song title" required class="element text large" type="text" value=""/> 
		</li>
		<li id="li_2" >
		<label class="description" for="%Lyrics%">Lyrics</label>
		<div>
			<textarea id="%Lyrics%" name="Song lyrics" class="element textarea medium"></textarea>
		</div>
		<input style="width:259px" type="button" value="Create lyrics documents" onmouseup="writeData()">
			<script>
			window.writeData = function()
			{
				 var vFormInfo = {};

				 var vLyricsNode = document.getElementById("%Lyrics%");
				 var vSongNameNode = document.getElementById("%SongName%");

				 // Ensure all forms have been filled in.
				 if (vLyricsNode.value.length === 0 || !vLyricsNode.value.trim())
				 {
					window.alert('"' + vLyricsNode.name + '" must not be empty.');
					return;
				 }
				 if (vSongNameNode.value.length === 0 || !vSongNameNode.value.trim())
				 {
					window.alert('"' + vSongNameNode.name + '" must not be empty.');
					return;
				 }

				 vFormInfo[vSongNameNode.id] = vSongNameNode.value;
				 vFormInfo[vLyricsNode.id] = vLyricsNode.value;

				 google.script.run.withSuccessHandler(OnSuccess)
					.withFailureHandler(onFailure)
					.CreateLyricsDocs(JSON.stringify(vFormInfo));
			};

			function OnSuccess(sDocUrl)
			{
				var bOpenDoc = window.confirm("Successfully created lyrical document.\r\n\r\n Do you want to open this document?");
				if (bOpenDoc)
					window.open(sDocUrl, "_blank")
			}

			function onFailure(vError)
			{
				 // Lyrics docs creation failed.
				 window.alert("Error: " + vError.message);
			}
			</script>
		</li>
		</ul>
		</form>

		<img src="top.png" style="width:270px;height:10px;margin-bottom:1px">
		<h1 style="Text-Align:Center">Bulletin Creator</h1>
		<img src="bottom.png" style="width:270px;height:10px;margin-top:1px">

		<form id="form_1710" class="appnitro" method="post" action="">
		<ul>
		<li id="li_1" >
		<label class="description" for="%Pastor%">Pastor</label>
		<div>
			<input id="%Pastor%" name="Pastor" required class="element text large" type="text" value=""/> 
		</li>		<li id="li_2" >
		<label class="description" for="%SermonTitle%">Sermon title</label>
		<div>
			<input id="%SermonTitle%" name="Sermon title" class="element text large" type="text" value=""/> 
		</div>
		</li>		<li id="li_3" >
		<label class="description" for="%Scripture%">Scripture reference</label>
		<div>
			<input id="%Scripture%" name="Scripture reference" required class="element text large" type="text" value=""/> 
		</div>
		</li>		<li id="li_4" >
		<label class="description" for="%Scripture_Passage%">Scripture passage</label>
		<div>
			<input id="%Scripture_Passage%" name="Scripture passage" required class="element text large" type="text" value=""/> 
		</div>
		</li>		<li id="li_5" >
		<label class="description" for="%HBCNum%">Heidelberg Catechism #</label>
		<div>
			<input id="%HBCNum%" name="Heidelberg Catechism #" required class="element text large" type="text" value=""/> 
		</li>		<li id="li_11" >
		<label class="description" for="%CongPrayer%">Who is doing the congregational prayer?</label>
		<div>
			<input id="%CongPrayer%" name="%CongPrayer%" required class="element text large" type="text" value=""/> 
		</div>
		</li>		<li id="li_12" >
		<label class="description" for="%ElderPrayer%">Who is doing the elder prayer?</label>
		<div>
			<input id="%ElderPrayer%" name="Who is doing the elder prayer?" required class="element text large" type="text" value=""/> 
		</div>
		</li>		<li id="li_13" >
		<label class="description" for="%Benediction%">Who is doing the benediction?</label>
		<div>
			<input id="%Benediction%" name="Who is doing the benediction?" required class="element text large" type="text" value=""/> 
		</div>
		</li>		<li id="li_6" >
		<label class="description" for="%Song1_Title%">First song</label>
		<div>
			<input id="%Song1_Title%" name="First song" required class="element text large" type="text" value=""/> 
		</div>
		</li>		<li id="li_7" >
		<label class="description" for="%Song2_Title%">Second song</label>
		<div>
			<input id="%Song2_Title%" name="Second song" required class="element text large" type="text" value=""/> 
		</div>
		</li>		<li id="li_8" >
		<label class="description" for="%Song3_Title%">Third song</label>
		<div>
			<input id="%Song3_Title%" name="Third song" required class="element text large" type="text" value=""/> 
		</div>
		</li>		<li id="li_9" >
		<label class="description" for="%Song4_Title%">Fourth song</label>
		<div>
			<input id="%Song4_Title%" name="Fourth song" required class="element text large" type="text" value=""/> 
		</div>
		</li>		<li id="li_10" >
		<label class="description" for="%SpecializedWelcome%">Specialized welcome</label>
		<div>
			<input id="%SpecializedWelcome%" name="Specialized welcome" required class="element text large" type="text" value=""/> 
		</div>
		</li>		<li id="li_14" >
		<label class="description" for="%YTDGiving%">Giving (YTD)</label>
		<div>
			<input id="%YTDGiving%" name="Giving (YTD)" class="element text large" type="text" value=""/> 
		</div>
		</li>		<li id="li_15" >
		<label class="description" for="%YTDExpenses%">Expenses (YTD)</label>
		<div>
			<input id="%YTDExpenses%" name="Expenses (YTD)" class="element text large" type="text" value=""/> 
		</div>
		</li>		<li id="li_16" >
		<label class="description" for="%AssetsRes%">Assets / Reserves</label>
		<div>
			<input id="%AssetsRes%" name="Assets / Reserves" class="element text large" type="text" value=""/> 
		</div>
		</li>	
		<li class="buttons">
		</li>
		</ul>
		</form>
	</div>
	</body>
<body>
          <input style="width:270px" type="button" value="Create bulletin (this may take awhile)" onmouseup="writeData()">
          <script>
          window.writeData = function()
          {
             var vFormInfo = {};

             var vFormNodes = document.getElementsByClassName("element text large");
             for (var i = 0; i < vFormNodes.length; i++)
             {
               var vNode = vFormNodes[i];
                
               // Ensure all required forms have been filled in.
               if (vNode.required && (vNode.value.length === 0 || !vNode.value.trim()))
               {
                 window.alert('"' + vNode.name + '" must not be empty.');
                 return;
               }
               // Ensure numbers really are numbers.
               if (vNode.id === "%YTDGiving%" || vNode.id === "%YTDExpenses%" || vNode.id === "%AssetsRes%")
               {
                 // Remove commas
                 var sVal = vNode.value;
                 vNode.value = sVal.replace(",", "");

                 // || vNode.value.indexOf(",") >= 0
                 if (isNaN(parseInt(vNode.value)))
                 {
                   window.alert('"' + vNode.name + '" must be a number without $.');
                   return;
                 }
               }
                
               vFormInfo[vNode.id] = vNode.value;
             }

             google.script.run.withSuccessHandler(OnBulletinCreated)
                .withFailureHandler(onFailure)
                .DoMagic(JSON.stringify(vFormInfo));
          };
          
          function OnBulletinCreated(sBulletinURL)
          {
             // Alert because sometimes the bulletin doesn't open.
             window.alert("Finished creating bulletin!");
             
             // Open newly created bulletin.
             window.open(sBulletinURL, "_blank")
          }
          
          function onFailure(vError)
          {
             // Bulletin creation failed.
             window.alert("Error: " + vError.message);
          }
          </script>
</body>
</html>